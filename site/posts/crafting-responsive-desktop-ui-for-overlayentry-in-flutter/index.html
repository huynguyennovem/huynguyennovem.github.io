<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Crafting responsive Desktop UI for OverlayEntry in Flutter - Huy Nguyen Blog</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Crafting responsive Desktop UI for OverlayEntry in Flutter";
        var mkdocs_page_input_path = "posts/crafting-responsive-desktop-ui-for-overlayentry-in-flutter.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Huy Nguyen Blog
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../">Posts</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../talks/">Talks</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../community_activities/">Community Activities</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../projects_packages/">Projects and packages</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../contributions/">Contributions</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Huy Nguyen Blog</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Crafting responsive Desktop UI for OverlayEntry in Flutter</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>In Flutter, OverlayEntry allows developers to create overlay widgets on top of existing UI elements. In this article, we will dive into the process of creating OverlayEntry, tackling the challenge of resizing window, and demonstrate its potential with a QR popup on NetShare. Let’s get started!</p>
<h3 id="overlayentry-overview">OverlayEntry overview</h3>
<p>OverlayEntry renders widgets on top of existing UI elements, providing the ability to create interactive and visually appealing overlays. To create a simple OverlayEntry, we can use the following code snippet:</p>
<pre><code class="language-dart">// Create an OverlayEntry
final overlayEntry = OverlayEntry(builder: (context) {}

// Add the OverlayEntry to the Overlay
Overlay.of(context, debugRequiredFor: widget).insert(overlayEntry!);
</code></pre>
<p>The problem is that we don’t have a specific location for it yet. So how to display OverlayEntry at the desired position?</p>
<p>Assume that we need to show the OverlayEntry at the button position when it is clicked. First, find the position of the button with <code>findRenderObject()</code> from button key and then use <code>localToGlobal()</code> to convert the local position to the global coordinate system. Next, use these positions in the Positioned widget. And finally fill up content for OverlayEntry, which is the child of Positioned.</p>
<pre><code class="language-dart"> _showOverlay() {
    _clearOverlay();

    final RenderBox buttonRenderBox = _buttonKey.currentContext?.findRenderObject() as RenderBox;
    final buttonSize = buttonRenderBox.size;
    final buttonPosition = buttonRenderBox.localToGlobal(Offset.zero);

    overlayEntry = OverlayEntry(builder: (context) {
      return GestureDetector(
          behavior: HitTestBehavior.translucent,
          onTap: _clearOverlay,
          child: Stack(
            children: [
              Positioned(
                top: buttonPosition.dy + buttonSize.height,
                left: buttonPosition.dx + buttonSize.height,
                child: SizedBox(
                  width: overlaySize,
                  height: overlaySize,
                  child: Container(
                    alignment: Alignment.center,
                    color: Colors.blue,
                    child: const Text(
                      'Hello',
                      style: TextStyle(
                        color: Colors.white,
                        fontSize: 16.0,
                        decoration: TextDecoration.none,
                      ),
                    ),
                  ),
                ),
              )
            ],
          ));
    });

    // Add the OverlayEntry to the Overlay.
    Overlay.of(context, debugRequiredFor: widget).insert(overlayEntry!);
  }

  _clearOverlay() {
    overlayEntry?.remove();
    overlayEntry = null;
  }
</code></pre>
<p>You may notice the snippet code above call to <code>_clearOverlay()</code> method. It’s just to make sure that only one OverlayEntry is shown with the action that triggered it.</p>
<p>And this is the result:</p>
<p><img alt="" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1710004536985/d52a3848-cb0d-4559-9b93-32e7a3fca973.gif" /></p>
<h3 id="responsive-overlayentry-on-desktop-ui">Responsive OverlayEntry on Desktop UI</h3>
<p>Even OverlayEntry can be displayed, it lacks the flexibility to adapt window resizing.</p>
<p><img alt="" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1710004604930/dc0bd53f-4f39-474f-9492-6cccf4827db1.gif" /></p>
<p>Resizing a window should not hinder the seamless experience of our overlays. To ensure that our OverlayEntry adapts to changes in window size, we can leverage the power of LayoutBuilder. By wrapping our overlay content with a LayoutBuilder widget, we gain access to the constraints of the parent container.</p>
<pre><code class="language-dart">  _showOverlay() {
    _clearOverlay();

    overlayEntry = OverlayEntry(builder: (context) {
      return GestureDetector(
        behavior: HitTestBehavior.translucent,
        onTap: _clearOverlay,
        child: LayoutBuilder(
          builder: (BuildContext context, BoxConstraints constraints) {
            final RenderBox buttonRenderBox = _buttonKey.currentContext?.findRenderObject() as RenderBox;
            final buttonSize = buttonRenderBox.size;
            final buttonPosition = buttonRenderBox.localToGlobal(Offset.zero);
            return Stack(
              children: [
                Positioned(
                  top: buttonPosition.dy + buttonSize.height,
                  left: buttonPosition.dx + buttonSize.height,
                  child: SizedBox(
                    width: overlaySize,
                    height: overlaySize,
                    child: Container(
                      alignment: Alignment.center,
                      color: Colors.blue,
                      child: const Text(
                        'Hello',
                        style: TextStyle(
                          color: Colors.white,
                          fontSize: 16.0,
                          decoration: TextDecoration.none,
                        ),
                      ),
                    ),
                  ),
                )
              ],
            );
          },
        ),
      );
    });

    // Add the OverlayEntry to the Overlay.
    Overlay.of(context, debugRequiredFor: widget).insert(overlayEntry!);
  }
</code></pre>
<p>Explain more about this, why do we include the button position calculation in LayoutBuilder? That’s because when the window resizes, the position of the button is also changed, so it is necessary to recalculate its position when the window resizing ends. Let’s see how this worked:</p>
<p><img alt="" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1710004615388/26c4c9ba-bdb5-44ad-a6c2-7b8947a128ae.gif" /></p>
<p>That’s great, right? Let’s check the complete source code for this demo at this <a href="https://gist.github.com/huynguyennovem/55f36f71f5b17b9834d5ee4e7654fba5">gist</a>.</p>
<h3 id="bringing-it-all-together-qr-popup-on-netshare">Bringing it All Together — QR Popup on NetShare</h3>
<p>To demonstrate the versatility of OverlayEntry, let’s take a look at QR popup on NetShare. <a href="https://github.com/huynguyennovem/netshare">NetShare</a> is an open-source Flutter project that makes it easy to share data in a local network. The latest release includes support for Android, macOS, Windows, and Linux platforms.</p>
<p><img alt="" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1710004647277/28a49538-26ba-4176-8164-b9b91dddcfd9.png" /></p>
<p>NetShare utilizes OverlayEntry to display a QR code overlay when the user clicks on the “QR” image button within the NetShare app in Server mode. The QR code overlay will provide a convenient way for users to quickly scan and access shared files on their mobile devices.</p>
<p><img alt="" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1710004689104/ed4ab90e-2ae6-44f2-85ba-820c5962f9a4.gif" /></p>
<p>In this article, we explored the fundamentals of OverlayEntry, tackled the challenge of resizing window, and demonstrated its potential by creating a captivating QR popup on NetShare. Armed with this knowledge, you can now unleash your creativity and build visually stunning and interactive desktop applications with Flutter.</p>
<p>Happy Flutter-ing!</p>
<p>Stay in touch with me for updates:</p>
<ul>
<li>
<p>Twitter: <a href="https://twitter.com/HuyNguyenTw">https://twitter.com/HuyNguyenTw</a></p>
</li>
<li>
<p>GitHub: <a href="https://github.com/huynguyennovem">https://github.com/huynguyennovem</a></p>
</li>
<li>
<p>LinkedIn: <a href="https://linkedin.com/in/huynguyennovem">https://linkedin.com/in/huynguyennovem</a></p>
</li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
